<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#DC2626">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>ë¸”ë™ì•„ì›ƒ ê°€ë””ì–¸ - ê°œì¸ ì•ˆì „ ì•±</title>
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel Standalone for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        * {
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }
        
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
            overflow-x: hidden;
        }

        /* í° ë²„íŠ¼ í˜¸ë²„ íš¨ê³¼ */
        @keyframes pulse-red {
            0%, 100% { box-shadow: 0 0 0 0 rgba(220, 38, 38, 0.7); }
            50% { box-shadow: 0 0 0 20px rgba(220, 38, 38, 0); }
        }

        .emergency-pulse {
            animation: pulse-red 2s infinite;
        }

        /* ë¡œë”© ìŠ¤í”¼ë„ˆ */
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .animate-spin {
            animation: spin 1s linear infinite;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // ==================== ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ====================
        const vibrate = (pattern) => {
            if ('vibrate' in navigator) {
                navigator.vibrate(pattern);
            }
        };

        const getCurrentLocation = () => {
            return new Promise((resolve) => {
                if ('geolocation' in navigator) {
                    navigator.geolocation.getCurrentPosition(
                        (position) => {
                            resolve({
                                latitude: position.coords.latitude,
                                longitude: position.coords.longitude,
                                accuracy: position.coords.accuracy
                            });
                        },
                        () => {
                            // ìœ„ì¹˜ ê¶Œí•œ ê±°ë¶€ ì‹œ ì„œìš¸ ì‹œì²­ ì¢Œí‘œ ë°˜í™˜
                            resolve({
                                latitude: 37.5665,
                                longitude: 126.9780,
                                accuracy: 0
                            });
                        }
                    );
                } else {
                    resolve({
                        latitude: 37.5665,
                        longitude: 126.9780,
                        accuracy: 0
                    });
                }
            });
        };

        const getBatteryLevel = async () => {
            if ('getBattery' in navigator) {
                try {
                    const battery = await navigator.getBattery();
                    return Math.round(battery.level * 100);
                } catch {
                    return 75;
                }
            }
            return 75;
        };

        // LocalStorage í—¬í¼ í•¨ìˆ˜
        const saveToLocalStorage = (key, value) => {
            try {
                localStorage.setItem(key, JSON.stringify(value));
            } catch (error) {
                console.error('LocalStorage ì €ì¥ ì‹¤íŒ¨:', error);
            }
        };

        const loadFromLocalStorage = (key, defaultValue) => {
            try {
                const item = localStorage.getItem(key);
                return item ? JSON.parse(item) : defaultValue;
            } catch (error) {
                console.error('LocalStorage ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨:', error);
                return defaultValue;
            }
        };

        // ==================== ë©”ì¸ ì•± ì»´í¬ë„ŒíŠ¸ ====================
        function BlackoutGuardianApp() {
            const [screen, setScreen] = useState('main');
            
            // localStorageì—ì„œ ì—°ë½ì²˜ ë¶ˆëŸ¬ì˜¤ê¸°
            const [contacts, setContacts] = useState(() => {
                return loadFromLocalStorage('contacts', [
                    { id: 1, name: 'ì—„ë§ˆ', phone: '010-1234-5678', priority: 1 },
                    { id: 2, name: 'ì¹œêµ¬', phone: '010-2345-6789', priority: 2 },
                    { id: 3, name: 'ë™ìƒ', phone: '010-3456-7890', priority: 3 }
                ]);
            });
            
            const [location, setLocation] = useState({ latitude: 0, longitude: 0 });
            const [battery, setBattery] = useState(0);
            const [countdown, setCountdown] = useState(30);
            const [isCountingDown, setIsCountingDown] = useState(false);
            
            // localStorageì—ì„œ ê¸´ê¸‰ ë¡œê·¸ ë¶ˆëŸ¬ì˜¤ê¸°
            const [emergencyLogs, setEmergencyLogs] = useState(() => {
                return loadFromLocalStorage('emergencyLogs', []);
            });
            
            // localStorageì—ì„œ ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸°
            const [settings, setSettings] = useState(() => {
                return loadFromLocalStorage('settings', {
                    countdownSeconds: 30,
                    enableVibration: true,
                    autoRecording: true
                });
            });

            // ì—°ë½ì²˜ ë³€ê²½ ì‹œ localStorageì— ì €ì¥
            useEffect(() => {
                saveToLocalStorage('contacts', contacts);
            }, [contacts]);

            // ê¸´ê¸‰ ë¡œê·¸ ë³€ê²½ ì‹œ localStorageì— ì €ì¥
            useEffect(() => {
                saveToLocalStorage('emergencyLogs', emergencyLogs);
            }, [emergencyLogs]);

            // ì„¤ì • ë³€ê²½ ì‹œ localStorageì— ì €ì¥
            useEffect(() => {
                saveToLocalStorage('settings', settings);
            }, [settings]);

            // ìœ„ì¹˜ ë° ë°°í„°ë¦¬ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
            useEffect(() => {
                const updateStatus = async () => {
                    const loc = await getCurrentLocation();
                    setLocation(loc);
                    
                    // Battery Status API ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§
                    if ('getBattery' in navigator) {
                        try {
                            const battery = await navigator.getBattery();
                            setBattery(Math.round(battery.level * 100));
                            
                            // ë°°í„°ë¦¬ ë ˆë²¨ ë³€ê²½ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
                            battery.addEventListener('levelchange', () => {
                                setBattery(Math.round(battery.level * 100));
                            });
                            
                            // ì¶©ì „ ìƒíƒœ ë³€ê²½ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
                            battery.addEventListener('chargingchange', () => {
                                console.log('ì¶©ì „ ìƒíƒœ:', battery.charging ? 'ì¶©ì „ ì¤‘' : 'ì¶©ì „ ì•ˆ í•¨');
                            });
                        } catch (error) {
                            console.error('Battery API ì˜¤ë¥˜:', error);
                            setBattery(75);
                        }
                    } else {
                        setBattery(75);
                    }
                };
                
                updateStatus();
                const interval = setInterval(() => {
                    getCurrentLocation().then(loc => setLocation(loc));
                }, 10000);
                
                return () => clearInterval(interval);
            }, []);

            const triggerStealth = () => {
                setScreen('stealth');
                setCountdown(settings.countdownSeconds);
                setIsCountingDown(true);
                if (settings.enableVibration) {
                    vibrate([200, 100, 200]);
                }
            };

            const cancelEmergency = () => {
                setIsCountingDown(false);
                setScreen('main');
                if (settings.enableVibration) {
                    vibrate([100, 50, 100]);
                }
            };

            const sendEmergencyAlert = async () => {
                const loc = await getCurrentLocation();
                const bat = await getBatteryLevel();
                const timestamp = new Date().toLocaleString('ko-KR');
                
                const message = `[ê¸´ê¸‰ ì•Œë¦¼] ë¸”ë™ì•„ì›ƒ ê°€ë””ì–¸
ë°œì‹  ì‹œê°: ${timestamp}
ìœ„ì¹˜: ìœ„ë„ ${loc.latitude.toFixed(6)}, ê²½ë„ ${loc.longitude.toFixed(6)}
ì§€ë„: https://maps.google.com/?q=${loc.latitude},${loc.longitude}
ë°°í„°ë¦¬: ${bat}%`;

                const log = {
                    id: Date.now(),
                    timestamp,
                    location: loc,
                    battery: bat,
                    contacts: contacts.map(c => c.name).join(', '),
                    status: 'sent'
                };
                setEmergencyLogs([log, ...emergencyLogs]);

                console.log('ğŸ“± ê¸´ê¸‰ ì•Œë¦¼ ì „ì†¡ë¨:');
                contacts.forEach(contact => {
                    console.log(`â†’ ${contact.name} (${contact.phone})`);
                    console.log(message);
                });

                if (settings.enableVibration) {
                    vibrate([500]);
                }

                alert(`âœ… ê¸´ê¸‰ ì•Œë¦¼ì´ ${contacts.length}ëª…ì—ê²Œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nì „ì†¡ ë‚´ìš©:\n${message}`);

                setTimeout(() => {
                    setScreen('main');
                    setIsCountingDown(false);
                }, 3000);
            };

            switch (screen) {
                case 'stealth':
                    return (
                        <StealthModeScreen
                            countdown={countdown}
                            setCountdown={setCountdown}
                            isCountingDown={isCountingDown}
                            onCancel={cancelEmergency}
                            onComplete={sendEmergencyAlert}
                            enableVibration={settings.enableVibration}
                        />
                    );
                case 'contacts':
                    return (
                        <ContactsScreen
                            contacts={contacts}
                            setContacts={setContacts}
                            onBack={() => setScreen('main')}
                        />
                    );
                case 'settings':
                    return (
                        <SettingsScreen
                            settings={settings}
                            setSettings={setSettings}
                            emergencyLogs={emergencyLogs}
                            onBack={() => setScreen('main')}
                        />
                    );
                default:
                    return (
                        <MainScreen
                            location={location}
                            battery={battery}
                            onEmergencyClick={triggerStealth}
                            onContactsClick={() => setScreen('contacts')}
                            onSettingsClick={() => setScreen('settings')}
                        />
                    );
            }
        }

        // ==================== ë©”ì¸ í™”ë©´ ====================
        function MainScreen({ location, battery, onEmergencyClick, onContactsClick, onSettingsClick }) {
            const [address, setAddress] = useState('ìœ„ì¹˜ í™•ì¸ ì¤‘...');
            const [isCharging, setIsCharging] = useState(false);

            useEffect(() => {
                if (location.latitude && location.longitude) {
                    setAddress(`ìœ„ë„ ${location.latitude.toFixed(4)}, ê²½ë„ ${location.longitude.toFixed(4)}`);
                }
            }, [location]);

            // ë°°í„°ë¦¬ ì¶©ì „ ìƒíƒœ í™•ì¸
            useEffect(() => {
                const checkCharging = async () => {
                    if ('getBattery' in navigator) {
                        try {
                            const battery = await navigator.getBattery();
                            setIsCharging(battery.charging);
                            
                            battery.addEventListener('chargingchange', () => {
                                setIsCharging(battery.charging);
                            });
                        } catch (error) {
                            console.error('Battery API ì˜¤ë¥˜:', error);
                        }
                    }
                };
                checkCharging();
            }, []);

            return (
                <div className="min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 flex flex-col">
                    <div className="bg-white shadow-sm p-6 text-center">
                        <h1 className="text-4xl font-bold text-gray-800">ğŸ›¡ï¸ ë¸”ë™ì•„ì›ƒ ê°€ë””ì–¸</h1>
                        <p className="text-gray-500 mt-2 text-lg">ë‹¹ì‹ ì˜ ì•ˆì „ì„ ì§€í‚µë‹ˆë‹¤</p>
                    </div>

                    <div className="flex-1 flex flex-col items-center justify-center p-6 space-y-6">
                        <button
                            onClick={onEmergencyClick}
                            className="emergency-pulse w-full max-w-md h-32 bg-red-600 hover:bg-red-700 active:bg-red-800 text-white rounded-3xl shadow-2xl transform transition-all hover:scale-105 active:scale-95"
                        >
                            <div className="flex items-center justify-center space-x-4">
                                <span className="text-5xl">ğŸš¨</span>
                                <span className="text-3xl font-bold">ê¸´ê¸‰ ì•Œë¦¼ ë³´ë‚´ê¸°</span>
                            </div>
                        </button>

                        <button
                            onClick={onContactsClick}
                            className="w-full max-w-md h-24 bg-blue-600 hover:bg-blue-700 active:bg-blue-800 text-white rounded-2xl shadow-xl transform transition-all hover:scale-105 active:scale-95"
                        >
                            <div className="flex items-center justify-center space-x-3">
                                <span className="text-4xl">ğŸ‘¥</span>
                                <span className="text-2xl font-bold">ë¹„ìƒ ì—°ë½ì²˜ ê´€ë¦¬</span>
                            </div>
                        </button>

                        <button
                            onClick={onSettingsClick}
                            className="w-full max-w-md h-24 bg-gray-600 hover:bg-gray-700 active:bg-gray-800 text-white rounded-2xl shadow-xl transform transition-all hover:scale-105 active:scale-95"
                        >
                            <div className="flex items-center justify-center space-x-3">
                                <span className="text-4xl">âš™ï¸</span>
                                <span className="text-2xl font-bold">ì„¤ì •</span>
                            </div>
                        </button>

                        <div className="w-full max-w-md bg-white rounded-2xl shadow-lg p-6 mt-8">
                            <h3 className="text-2xl font-bold text-gray-800 mb-4">ğŸ“ í˜„ì¬ ìƒíƒœ</h3>
                            <div className="space-y-3">
                                <div className="flex items-center space-x-3">
                                    <span className="text-2xl">ğŸ“</span>
                                    <div>
                                        <p className="text-sm text-gray-500">ìœ„ì¹˜</p>
                                        <p className="text-lg font-medium text-gray-800">{address}</p>
                                    </div>
                                </div>
                                <div className="flex items-center space-x-3">
                                    <span className="text-2xl">{isCharging ? 'âš¡' : 'ğŸ”‹'}</span>
                                    <div>
                                        <p className="text-sm text-gray-500">ë°°í„°ë¦¬</p>
                                        <p className="text-lg font-medium text-gray-800">
                                            {battery}% {isCharging && <span className="text-green-600">(ì¶©ì „ ì¤‘)</span>}
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <button
                        onClick={onEmergencyClick}
                        className="fixed bottom-4 right-4 w-16 h-16 bg-red-500 bg-opacity-20 hover:bg-opacity-40 rounded-full shadow-lg transition-all"
                        aria-label="ìŠ¤í…”ìŠ¤ í™œì„±í™”"
                    >
                        <span className="text-2xl opacity-30">ğŸš¨</span>
                    </button>
                </div>
            );
        }

        // ==================== ìŠ¤í…”ìŠ¤ ëª¨ë“œ í™”ë©´ ====================
        function StealthModeScreen({ countdown, setCountdown, isCountingDown, onCancel, onComplete, enableVibration }) {
            const timerRef = useRef(null);
            const mediaRecorderRef = useRef(null);
            const audioChunksRef = useRef([]);
            const [isRecording, setIsRecording] = useState(false);
            const [recordingError, setRecordingError] = useState(null);

            // ë…¹ìŒ ì‹œì‘
            useEffect(() => {
                const startRecording = async () => {
                    try {
                        const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                        const mediaRecorder = new MediaRecorder(stream);
                        mediaRecorderRef.current = mediaRecorder;
                        audioChunksRef.current = [];

                        mediaRecorder.ondataavailable = (event) => {
                            if (event.data.size > 0) {
                                audioChunksRef.current.push(event.data);
                            }
                        };

                        mediaRecorder.onstop = () => {
                            const audioBlob = new Blob(audioChunksRef.current, { type: 'audio/webm' });
                            const audioUrl = URL.createObjectURL(audioBlob);
                            
                            // ë…¹ìŒ íŒŒì¼ ë‹¤ìš´ë¡œë“œ
                            const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
                            const fileName = `emergency_recording_${timestamp}.webm`;
                            
                            const a = document.createElement('a');
                            a.href = audioUrl;
                            a.download = fileName;
                            a.click();
                            
                            console.log('âœ… ë…¹ìŒ ì™„ë£Œ! íŒŒì¼:', fileName);
                            
                            // ìŠ¤íŠ¸ë¦¼ ì¢…ë£Œ
                            stream.getTracks().forEach(track => track.stop());
                        };

                        mediaRecorder.start();
                        setIsRecording(true);
                        console.log('ğŸ™ï¸ ë…¹ìŒ ì‹œì‘ë¨');
                    } catch (error) {
                        console.error('ë…¹ìŒ ì˜¤ë¥˜:', error);
                        setRecordingError('ë§ˆì´í¬ ê¶Œí•œì´ ê±°ë¶€ë˜ì—ˆê±°ë‚˜ ë…¹ìŒì„ ì‹œì‘í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    }
                };

                startRecording();

                return () => {
                    // ì»´í¬ë„ŒíŠ¸ ì–¸ë§ˆìš´íŠ¸ ì‹œ ë…¹ìŒ ì¤‘ì§€
                    if (mediaRecorderRef.current && mediaRecorderRef.current.state !== 'inactive') {
                        mediaRecorderRef.current.stop();
                    }
                };
            }, []);

            // ì¹´ìš´íŠ¸ë‹¤ìš´ íƒ€ì´ë¨¸
            useEffect(() => {
                if (isCountingDown && countdown > 0) {
                    timerRef.current = setInterval(() => {
                        setCountdown(prev => {
                            const newVal = prev - 1;
                            
                            if (newVal > 0 && newVal % 5 === 0 && enableVibration) {
                                vibrate([100]);
                            }
                            
                            if (newVal <= 0) {
                                clearInterval(timerRef.current);
                                
                                // ë…¹ìŒ ì¤‘ì§€
                                if (mediaRecorderRef.current && mediaRecorderRef.current.state !== 'inactive') {
                                    mediaRecorderRef.current.stop();
                                }
                                
                                onComplete();
                                return 0;
                            }
                            
                            return newVal;
                        });
                    }, 1000);
                }

                return () => {
                    if (timerRef.current) {
                        clearInterval(timerRef.current);
                    }
                };
            }, [isCountingDown, countdown]);

            const handleCancel = () => {
                // ë…¹ìŒ ì¤‘ì§€ ë° ì‚­ì œ
                if (mediaRecorderRef.current && mediaRecorderRef.current.state !== 'inactive') {
                    mediaRecorderRef.current.stop();
                    // ìŠ¤íŠ¸ë¦¼ ì¢…ë£Œí•˜ê³  ë…¹ìŒ ë°ì´í„° ì‚­ì œ
                    if (mediaRecorderRef.current.stream) {
                        mediaRecorderRef.current.stream.getTracks().forEach(track => track.stop());
                    }
                    audioChunksRef.current = [];
                    console.log('âŒ ë…¹ìŒ ì·¨ì†Œë¨');
                }
                onCancel();
            };

            return (
                <div className="min-h-screen bg-black flex items-center justify-center p-6">
                    <div className="text-center space-y-12">
                        <div className="text-white text-opacity-30">
                            <div className="text-8xl font-bold mb-2">{countdown}</div>
                            <div className="text-2xl">ì´ˆ ë‚¨ìŒ</div>
                        </div>

                        <div className="w-64 h-3 bg-white bg-opacity-10 rounded-full overflow-hidden mx-auto">
                            <div 
                                className="h-full bg-red-500 bg-opacity-50 transition-all duration-1000"
                                style={{ width: `${((30 - countdown) / 30) * 100}%` }}
                            />
                        </div>

                        <button
                            onClick={handleCancel}
                            className="w-72 h-24 bg-white bg-opacity-20 hover:bg-opacity-30 active:bg-opacity-40 text-white rounded-2xl shadow-2xl transform transition-all hover:scale-105 active:scale-95"
                        >
                            <div className="text-3xl font-bold">âœ• ì·¨ì†Œ</div>
                        </button>

                        <div className="text-white text-opacity-50 text-lg">
                            {countdown > 0 ? 'ê¸´ê¸‰ ì•Œë¦¼ ì „ì†¡ ëŒ€ê¸° ì¤‘...' : 'ì•Œë¦¼ ì „ì†¡ ì™„ë£Œ'}
                        </div>

                        {isRecording && countdown > 0 && (
                            <div className="flex items-center justify-center space-x-3 text-white text-opacity-60">
                                <div className="w-3 h-3 bg-red-500 rounded-full animate-pulse" />
                                <span className="text-base">ğŸ™ï¸ ìŒì„± ë…¹ìŒ ì¤‘</span>
                            </div>
                        )}

                        {recordingError && (
                            <div className="text-yellow-400 text-sm px-4 py-2 bg-yellow-900 bg-opacity-30 rounded-lg">
                                âš ï¸ {recordingError}
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        // ==================== ì—°ë½ì²˜ ê´€ë¦¬ í™”ë©´ ====================
        function ContactsScreen({ contacts, setContacts, onBack }) {
            const [isAdding, setIsAdding] = useState(false);
            const [newContact, setNewContact] = useState({ name: '', phone: '' });

            const addContact = () => {
                if (newContact.name && newContact.phone) {
                    setContacts([
                        ...contacts,
                        {
                            id: Date.now(),
                            name: newContact.name,
                            phone: newContact.phone,
                            priority: contacts.length + 1
                        }
                    ]);
                    setNewContact({ name: '', phone: '' });
                    setIsAdding(false);
                }
            };

            const deleteContact = (id) => {
                if (confirm('ì´ ì—°ë½ì²˜ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    setContacts(contacts.filter(c => c.id !== id));
                }
            };

            return (
                <div className="min-h-screen bg-gray-50">
                    <div className="bg-white shadow-sm p-6 flex items-center justify-between">
                        <button
                            onClick={onBack}
                            className="text-3xl text-gray-600 hover:text-gray-800"
                        >
                            â† 
                        </button>
                        <h2 className="text-3xl font-bold text-gray-800">ğŸ‘¥ ë¹„ìƒ ì—°ë½ì²˜</h2>
                        <button
                            onClick={() => setIsAdding(true)}
                            className="text-3xl text-blue-600 hover:text-blue-700"
                        >
                            +
                        </button>
                    </div>

                    <div className="p-6 space-y-4">
                        {contacts.map((contact, index) => (
                            <div key={contact.id} className="bg-white rounded-xl shadow-md p-6 flex items-center justify-between">
                                <div className="flex items-center space-x-4">
                                    <div className="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center text-2xl font-bold text-blue-600">
                                        {index + 1}
                                    </div>
                                    <div>
                                        <h3 className="text-2xl font-bold text-gray-800">{contact.name}</h3>
                                        <p className="text-lg text-gray-500">{contact.phone}</p>
                                    </div>
                                </div>
                                <button
                                    onClick={() => deleteContact(contact.id)}
                                    className="text-3xl text-red-500 hover:text-red-700"
                                >
                                    ğŸ—‘ï¸
                                </button>
                            </div>
                        ))}
                    </div>

                    {isAdding && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-6 z-50">
                            <div className="bg-white rounded-2xl p-8 w-full max-w-md space-y-6">
                                <h3 className="text-3xl font-bold text-gray-800">ìƒˆ ì—°ë½ì²˜ ì¶”ê°€</h3>
                                
                                <input
                                    type="text"
                                    placeholder="ì´ë¦„"
                                    value={newContact.name}
                                    onChange={(e) => setNewContact({ ...newContact, name: e.target.value })}
                                    className="w-full px-6 py-4 text-2xl border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:outline-none"
                                />
                                
                                <input
                                    type="tel"
                                    placeholder="ì „í™”ë²ˆí˜¸ (010-1234-5678)"
                                    value={newContact.phone}
                                    onChange={(e) => setNewContact({ ...newContact, phone: e.target.value })}
                                    className="w-full px-6 py-4 text-2xl border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:outline-none"
                                />
                                
                                <div className="flex space-x-4">
                                    <button
                                        onClick={() => setIsAdding(false)}
                                        className="flex-1 py-4 text-xl font-bold text-gray-600 bg-gray-200 hover:bg-gray-300 rounded-xl"
                                    >
                                        ì·¨ì†Œ
                                    </button>
                                    <button
                                        onClick={addContact}
                                        className="flex-1 py-4 text-xl font-bold text-white bg-blue-600 hover:bg-blue-700 rounded-xl"
                                    >
                                        ì¶”ê°€
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        // ==================== ì„¤ì • í™”ë©´ ====================
        function SettingsScreen({ settings, setSettings, emergencyLogs, onBack }) {
            return (
                <div className="min-h-screen bg-gray-50">
                    <div className="bg-white shadow-sm p-6 flex items-center">
                        <button
                            onClick={onBack}
                            className="text-3xl text-gray-600 hover:text-gray-800 mr-4"
                        >
                            â†
                        </button>
                        <h2 className="text-3xl font-bold text-gray-800">âš™ï¸ ì„¤ì •</h2>
                    </div>

                    <div className="p-6 space-y-6">
                        <div className="bg-white rounded-xl shadow-md p-6">
                            <h3 className="text-2xl font-bold text-gray-800 mb-4">â±ï¸ ì¹´ìš´íŠ¸ë‹¤ìš´ ì‹œê°„</h3>
                            <div className="flex items-center justify-between">
                                <span className="text-xl text-gray-600">{settings.countdownSeconds}ì´ˆ</span>
                                <input
                                    type="range"
                                    min="15"
                                    max="60"
                                    step="5"
                                    value={settings.countdownSeconds}
                                    onChange={(e) => setSettings({ ...settings, countdownSeconds: parseInt(e.target.value) })}
                                    className="w-48 h-3"
                                />
                            </div>
                        </div>

                        <div className="bg-white rounded-xl shadow-md p-6">
                            <div className="flex items-center justify-between">
                                <div>
                                    <h3 className="text-2xl font-bold text-gray-800">ğŸ“³ ì§„ë™ ì•Œë¦¼</h3>
                                    <p className="text-lg text-gray-500 mt-1">ì¹´ìš´íŠ¸ë‹¤ìš´ ì‹œ ì§„ë™ìœ¼ë¡œ ì•Œë¦¼</p>
                                </div>
                                <button
                                    onClick={() => setSettings({ ...settings, enableVibration: !settings.enableVibration })}
                                    className={`w-20 h-10 rounded-full transition-colors ${
                                        settings.enableVibration ? 'bg-blue-600' : 'bg-gray-300'
                                    }`}
                                >
                                    <div className={`w-8 h-8 bg-white rounded-full shadow-md transform transition-transform ${
                                        settings.enableVibration ? 'translate-x-10' : 'translate-x-1'
                                    }`} />
                                </button>
                            </div>
                        </div>

                        <div className="bg-white rounded-xl shadow-md p-6">
                            <div className="flex items-center justify-between">
                                <div>
                                    <h3 className="text-2xl font-bold text-gray-800">ğŸ™ï¸ ìë™ ë…¹ìŒ</h3>
                                    <p className="text-lg text-gray-500 mt-1">ê¸´ê¸‰ ìƒí™© ì‹œ ìë™ìœ¼ë¡œ ë…¹ìŒ ì‹œì‘</p>
                                </div>
                                <button
                                    onClick={() => setSettings({ ...settings, autoRecording: !settings.autoRecording })}
                                    className={`w-20 h-10 rounded-full transition-colors ${
                                        settings.autoRecording ? 'bg-blue-600' : 'bg-gray-300'
                                    }`}
                                >
                                    <div className={`w-8 h-8 bg-white rounded-full shadow-md transform transition-transform ${
                                        settings.autoRecording ? 'translate-x-10' : 'translate-x-1'
                                    }`} />
                                </button>
                            </div>
                        </div>

                        <div className="bg-white rounded-xl shadow-md p-6">
                            <h3 className="text-2xl font-bold text-gray-800 mb-4">ğŸ“œ ê¸´ê¸‰ ì´ë²¤íŠ¸ ê¸°ë¡</h3>
                            {emergencyLogs.length === 0 ? (
                                <p className="text-lg text-gray-400 text-center py-8">ì•„ì§ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤</p>
                            ) : (
                                <div className="space-y-3">
                                    {emergencyLogs.slice(0, 5).map((log) => (
                                        <div key={log.id} className="border-l-4 border-red-500 pl-4 py-2">
                                            <div className="text-lg font-semibold text-gray-800">{log.timestamp}</div>
                                            <div className="text-sm text-gray-600">
                                                ìœ„ì¹˜: {log.location.latitude.toFixed(6)}, {log.location.longitude.toFixed(6)}
                                            </div>
                                            <div className="text-sm text-gray-600">ë°°í„°ë¦¬: {log.battery}%</div>
                                            <div className="text-sm text-gray-600">ì „ì†¡: {log.contacts}</div>
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        // ==================== ì•± ë Œë”ë§ ====================
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<BlackoutGuardianApp />);
    </script>
</body>
</html>
