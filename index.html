<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#DC2626">
    <title>ë¸”ë™ì•„ì›ƒ ê°€ë””ì–¸ - SMS ìë™í™” ê°œì„ íŒ</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        * {
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }
        
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            overflow-x: hidden;
        }

        @keyframes pulse-red {
            0%, 100% { box-shadow: 0 0 0 0 rgba(220, 38, 38, 0.7); }
            50% { box-shadow: 0 0 0 20px rgba(220, 38, 38, 0); }
        }

        .emergency-pulse {
            animation: pulse-red 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .bounce-animation {
            animation: bounce 1s infinite;
        }

        /* ìë™ í´ë¦­ì„ ìœ„í•œ ìˆ¨ê²¨ì§„ ë§í¬ */
        .hidden-sms-link {
            position: fixed;
            left: -9999px;
            opacity: 0;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // ==================== SMS ì „ì†¡ ìœ í‹¸ë¦¬í‹° ====================
        
        // ë°©ë²• 1: ë™ì  ë§í¬ + ìë™ í´ë¦­ (ê°€ì¥ íš¨ê³¼ì )
        const sendSMSViaAutoClick = (phone, message) => {
            const link = document.createElement('a');
            link.href = `sms:${phone}?body=${encodeURIComponent(message)}`;
            link.style.display = 'none';
            document.body.appendChild(link);
            
            // ì•½ê°„ì˜ ì§€ì—° í›„ í´ë¦­ (ë³´ì•ˆ ì •ì±… ìš°íšŒ)
            setTimeout(() => {
                link.click();
                document.body.removeChild(link);
            }, 100);
        };

        // ë°©ë²• 2: ë©€í‹° SMS (ì—¬ëŸ¬ ì—°ë½ì²˜ ìˆœì°¨ ì „ì†¡)
        const sendMultipleSMS = async (contacts, message) => {
            for (let i = 0; i < contacts.length; i++) {
                const contact = contacts[i];
                
                // ê° SMS ì‚¬ì´ì— ì§€ì—° (ì‚¬ìš©ìê°€ í™•ì¸í•  ì‹œê°„)
                if (i > 0) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
                
                sendSMSViaAutoClick(contact.phone, message);
            }
        };

        // ë°©ë²• 3: ì•ˆë“œë¡œì´ë“œ ì¸í…íŠ¸ ìŠ¤íƒ€ì¼ (ë” ê°•ë ¥)
        const sendSMSViaIntent = (phone, message) => {
            // ì•ˆë“œë¡œì´ë“œ ì¸í…íŠ¸ URL ìŠ¤í‚´
            const intentUrl = `intent://send?address=${phone}&sms_body=${encodeURIComponent(message)}#Intent;scheme=sms;package=com.android.mms;end`;
            
            try {
                window.location.href = intentUrl;
            } catch (e) {
                // Fallback to normal SMS link
                window.location.href = `sms:${phone}?body=${encodeURIComponent(message)}`;
            }
        };

        // ==================== ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ====================
        const vibrate = (pattern) => {
            if ('vibrate' in navigator) {
                navigator.vibrate(pattern);
            }
        };

        const getCurrentLocation = () => {
            return new Promise((resolve) => {
                if ('geolocation' in navigator) {
                    navigator.geolocation.getCurrentPosition(
                        (position) => {
                            resolve({
                                latitude: position.coords.latitude,
                                longitude: position.coords.longitude,
                                accuracy: position.coords.accuracy
                            });
                        },
                        () => {
                            resolve({
                                latitude: 37.5665,
                                longitude: 126.9780,
                                accuracy: 0
                            });
                        }
                    );
                } else {
                    resolve({
                        latitude: 37.5665,
                        longitude: 126.9780,
                        accuracy: 0
                    });
                }
            });
        };

        const getBatteryLevel = async () => {
            if ('getBattery' in navigator) {
                try {
                    const battery = await navigator.getBattery();
                    return Math.round(battery.level * 100);
                } catch {
                    return 75;
                }
            }
            return 75;
        };

        const saveToLocalStorage = (key, value) => {
            try {
                localStorage.setItem(key, JSON.stringify(value));
            } catch (error) {
                console.error('LocalStorage ì €ì¥ ì‹¤íŒ¨:', error);
            }
        };

        const loadFromLocalStorage = (key, defaultValue) => {
            try {
                const item = localStorage.getItem(key);
                return item ? JSON.parse(item) : defaultValue;
            } catch (error) {
                console.error('LocalStorage ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨:', error);
                return defaultValue;
            }
        };

        // ==================== ë©”ì¸ ì•± ì»´í¬ë„ŒíŠ¸ ====================
        function BlackoutGuardianApp() {
            const [screen, setScreen] = useState('main');
            const [contacts, setContacts] = useState(() => {
                return loadFromLocalStorage('contacts', [
                    { id: 1, name: 'ì—„ë§ˆ', phone: '01012345678', priority: 1 },
                    { id: 2, name: 'ì¹œêµ¬', phone: '01023456789', priority: 2 },
                    { id: 3, name: 'ë™ìƒ', phone: '01034567890', priority: 3 }
                ]);
            });
            
            const [location, setLocation] = useState({ latitude: 0, longitude: 0 });
            const [battery, setBattery] = useState(0);
            const [countdown, setCountdown] = useState(30);
            const [isCountingDown, setIsCountingDown] = useState(false);
            const [emergencyLogs, setEmergencyLogs] = useState(() => {
                return loadFromLocalStorage('emergencyLogs', []);
            });
            const [settings, setSettings] = useState(() => {
                return loadFromLocalStorage('settings', {
                    countdownSeconds: 30,
                    enableVibration: true,
                    smsMethod: 'auto-click' // 'auto-click', 'intent', 'manual'
                });
            });

            useEffect(() => {
                saveToLocalStorage('contacts', contacts);
            }, [contacts]);

            useEffect(() => {
                saveToLocalStorage('emergencyLogs', emergencyLogs);
            }, [emergencyLogs]);

            useEffect(() => {
                saveToLocalStorage('settings', settings);
            }, [settings]);

            useEffect(() => {
                const updateStatus = async () => {
                    const loc = await getCurrentLocation();
                    setLocation(loc);
                    
                    if ('getBattery' in navigator) {
                        try {
                            const battery = await navigator.getBattery();
                            setBattery(Math.round(battery.level * 100));
                            
                            battery.addEventListener('levelchange', () => {
                                setBattery(Math.round(battery.level * 100));
                            });
                        } catch (error) {
                            setBattery(75);
                        }
                    } else {
                        setBattery(75);
                    }
                };
                
                updateStatus();
                const interval = setInterval(() => {
                    getCurrentLocation().then(loc => setLocation(loc));
                }, 10000);
                
                return () => clearInterval(interval);
            }, []);

            const triggerStealth = () => {
                setScreen('stealth');
                setCountdown(settings.countdownSeconds);
                setIsCountingDown(true);
                if (settings.enableVibration) {
                    vibrate([200, 100, 200]);
                }
            };

            const cancelEmergency = () => {
                setIsCountingDown(false);
                setScreen('main');
                if (settings.enableVibration) {
                    vibrate([100, 50, 100]);
                }
            };

            const sendEmergencyAlert = async () => {
                const loc = await getCurrentLocation();
                const bat = await getBatteryLevel();
                const timestamp = new Date().toLocaleString('ko-KR');
                
                const message = `[ê¸´ê¸‰] ë¸”ë™ì•„ì›ƒ ê°€ë””ì–¸
ì‹œê°: ${timestamp}
ìœ„ì¹˜: https://maps.google.com/?q=${loc.latitude},${loc.longitude}
ë°°í„°ë¦¬: ${bat}%`;

                const log = {
                    id: Date.now(),
                    timestamp,
                    location: loc,
                    battery: bat,
                    contacts: contacts.map(c => c.name).join(', '),
                    status: 'sent'
                };
                setEmergencyLogs([log, ...emergencyLogs]);

                if (settings.enableVibration) {
                    vibrate([500]);
                }

                // SMS ì „ì†¡ (ì„ íƒëœ ë°©ë²•ì— ë”°ë¼)
                switch (settings.smsMethod) {
                    case 'auto-click':
                        await sendMultipleSMS(contacts, message);
                        break;
                    case 'intent':
                        contacts.forEach(contact => {
                            sendSMSViaIntent(contact.phone, message);
                        });
                        break;
                    case 'manual':
                        // ìˆ˜ë™ ì „ì†¡ í™”ë©´ìœ¼ë¡œ ì´ë™
                        setScreen('sms-manual');
                        return;
                }

                setTimeout(() => {
                    setScreen('main');
                    setIsCountingDown(false);
                }, 2000);
            };

            switch (screen) {
                case 'stealth':
                    return (
                        <StealthModeScreen
                            countdown={countdown}
                            setCountdown={setCountdown}
                            isCountingDown={isCountingDown}
                            onCancel={cancelEmergency}
                            onComplete={sendEmergencyAlert}
                            enableVibration={settings.enableVibration}
                        />
                    );
                case 'sms-manual':
                    return (
                        <ManualSMSScreen
                            contacts={contacts}
                            location={location}
                            battery={battery}
                            onBack={() => setScreen('main')}
                        />
                    );
                case 'contacts':
                    return (
                        <ContactsScreen
                            contacts={contacts}
                            setContacts={setContacts}
                            onBack={() => setScreen('main')}
                        />
                    );
                case 'settings':
                    return (
                        <SettingsScreen
                            settings={settings}
                            setSettings={setSettings}
                            emergencyLogs={emergencyLogs}
                            onBack={() => setScreen('main')}
                        />
                    );
                default:
                    return (
                        <MainScreen
                            location={location}
                            battery={battery}
                            onEmergencyClick={triggerStealth}
                            onContactsClick={() => setScreen('contacts')}
                            onSettingsClick={() => setScreen('settings')}
                        />
                    );
            }
        }

        // ==================== ë©”ì¸ í™”ë©´ ====================
        function MainScreen({ location, battery, onEmergencyClick, onContactsClick, onSettingsClick }) {
            const [address, setAddress] = useState('ìœ„ì¹˜ í™•ì¸ ì¤‘...');
            const [isCharging, setIsCharging] = useState(false);

            useEffect(() => {
                if (location.latitude && location.longitude) {
                    setAddress(`ìœ„ë„ ${location.latitude.toFixed(4)}, ê²½ë„ ${location.longitude.toFixed(4)}`);
                }
            }, [location]);

            useEffect(() => {
                const checkCharging = async () => {
                    if ('getBattery' in navigator) {
                        try {
                            const battery = await navigator.getBattery();
                            setIsCharging(battery.charging);
                            
                            battery.addEventListener('chargingchange', () => {
                                setIsCharging(battery.charging);
                            });
                        } catch (error) {
                            console.error('Battery API ì˜¤ë¥˜:', error);
                        }
                    }
                };
                checkCharging();
            }, []);

            return (
                <div className="min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 flex flex-col">
                    <div className="bg-white shadow-sm p-6 text-center">
                        <h1 className="text-4xl font-bold text-gray-800">ğŸ›¡ï¸ ë¸”ë™ì•„ì›ƒ ê°€ë””ì–¸</h1>
                        <p className="text-gray-500 mt-2 text-lg">SMS ìë™í™” ê°œì„ íŒ</p>
                    </div>

                    <div className="flex-1 flex flex-col items-center justify-center p-6 space-y-6">
                        <button
                            onClick={onEmergencyClick}
                            className="emergency-pulse w-full max-w-md h-32 bg-red-600 hover:bg-red-700 active:bg-red-800 text-white rounded-3xl shadow-2xl transform transition-all hover:scale-105 active:scale-95"
                        >
                            <div className="flex items-center justify-center space-x-4">
                                <span className="text-5xl">ğŸš¨</span>
                                <span className="text-3xl font-bold">ê¸´ê¸‰ ì•Œë¦¼ ë³´ë‚´ê¸°</span>
                            </div>
                        </button>

                        <button
                            onClick={onContactsClick}
                            className="w-full max-w-md h-24 bg-blue-600 hover:bg-blue-700 active:bg-blue-800 text-white rounded-2xl shadow-xl transform transition-all hover:scale-105 active:scale-95"
                        >
                            <div className="flex items-center justify-center space-x-3">
                                <span className="text-4xl">ğŸ‘¥</span>
                                <span className="text-2xl font-bold">ë¹„ìƒ ì—°ë½ì²˜ ê´€ë¦¬</span>
                            </div>
                        </button>

                        <button
                            onClick={onSettingsClick}
                            className="w-full max-w-md h-24 bg-gray-600 hover:bg-gray-700 active:bg-gray-800 text-white rounded-2xl shadow-xl transform transition-all hover:scale-105 active:scale-95"
                        >
                            <div className="flex items-center justify-center space-x-3">
                                <span className="text-4xl">âš™ï¸</span>
                                <span className="text-2xl font-bold">ì„¤ì •</span>
                            </div>
                        </button>

                        <div className="w-full max-w-md bg-white rounded-2xl shadow-lg p-6 mt-8">
                            <h3 className="text-2xl font-bold text-gray-800 mb-4">ğŸ“ í˜„ì¬ ìƒíƒœ</h3>
                            <div className="space-y-3">
                                <div className="flex items-center space-x-3">
                                    <span className="text-2xl">ğŸ“</span>
                                    <div>
                                        <p className="text-sm text-gray-500">ìœ„ì¹˜</p>
                                        <p className="text-lg font-medium text-gray-800">{address}</p>
                                    </div>
                                </div>
                                <div className="flex items-center space-x-3">
                                    <span className="text-2xl">{isCharging ? 'âš¡' : 'ğŸ”‹'}</span>
                                    <div>
                                        <p className="text-sm text-gray-500">ë°°í„°ë¦¬</p>
                                        <p className="text-lg font-medium text-gray-800">
                                            {battery}% {isCharging && <span className="text-green-600">(ì¶©ì „ ì¤‘)</span>}
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <button
                        onClick={onEmergencyClick}
                        className="fixed bottom-4 right-4 w-16 h-16 bg-red-500 bg-opacity-20 hover:bg-opacity-40 rounded-full shadow-lg transition-all"
                        aria-label="ìŠ¤í…”ìŠ¤ í™œì„±í™”"
                    >
                        <span className="text-2xl opacity-30">ğŸš¨</span>
                    </button>
                </div>
            );
        }

        // ==================== ìŠ¤í…”ìŠ¤ ëª¨ë“œ í™”ë©´ ====================
        function StealthModeScreen({ countdown, setCountdown, isCountingDown, onCancel, onComplete, enableVibration }) {
            const timerRef = useRef(null);
            const [showSendButton, setShowSendButton] = useState(false);

            useEffect(() => {
                if (isCountingDown && countdown > 0) {
                    timerRef.current = setInterval(() => {
                        setCountdown(prev => {
                            const newVal = prev - 1;
                            
                            if (newVal > 0 && newVal % 5 === 0 && enableVibration) {
                                vibrate([100]);
                            }
                            
                            if (newVal <= 0) {
                                clearInterval(timerRef.current);
                                setShowSendButton(true);
                                
                                // 1ì´ˆ í›„ ìë™ ì „ì†¡ (ì‚¬ìš©ì ì œìŠ¤ì²˜ í™œìš©)
                                setTimeout(() => {
                                    onComplete();
                                }, 1000);
                                
                                return 0;
                            }
                            
                            return newVal;
                        });
                    }, 1000);
                }

                return () => {
                    if (timerRef.current) {
                        clearInterval(timerRef.current);
                    }
                };
            }, [isCountingDown, countdown]);

            return (
                <div className="min-h-screen bg-black flex items-center justify-center p-6">
                    <div className="text-center space-y-12">
                        {!showSendButton ? (
                            <>
                                <div className="text-white text-opacity-30">
                                    <div className="text-8xl font-bold mb-2">{countdown}</div>
                                    <div className="text-2xl">ì´ˆ ë‚¨ìŒ</div>
                                </div>

                                <div className="w-64 h-3 bg-white bg-opacity-10 rounded-full overflow-hidden mx-auto">
                                    <div 
                                        className="h-full bg-red-500 bg-opacity-50 transition-all duration-1000"
                                        style={{ width: `${((30 - countdown) / 30) * 100}%` }}
                                    />
                                </div>

                                <button
                                    onClick={onCancel}
                                    className="w-72 h-24 bg-white bg-opacity-20 hover:bg-opacity-30 active:bg-opacity-40 text-white rounded-2xl shadow-2xl transform transition-all hover:scale-105 active:scale-95"
                                >
                                    <div className="text-3xl font-bold">âœ• ì·¨ì†Œ</div>
                                </button>

                                <div className="text-white text-opacity-50 text-lg">
                                    ê¸´ê¸‰ ì•Œë¦¼ ì „ì†¡ ëŒ€ê¸° ì¤‘...
                                </div>
                            </>
                        ) : (
                            <>
                                <div className="text-white text-opacity-50 text-3xl mb-8">
                                    â° ì‹œê°„ ì¢…ë£Œ!
                                </div>

                                <button
                                    onClick={onComplete}
                                    className="bounce-animation w-80 h-32 bg-red-600 hover:bg-red-700 active:bg-red-800 text-white rounded-3xl shadow-2xl transform transition-all"
                                >
                                    <div className="text-4xl font-bold">ğŸ“± ê¸´ê¸‰ ë¬¸ì ë³´ë‚´ê¸°</div>
                                    <div className="text-lg mt-2">íƒ­í•˜ì—¬ ì „ì†¡</div>
                                </button>

                                <div className="text-white text-opacity-40 text-sm">
                                    ìë™ ì „ì†¡ ì‹œë„ ì¤‘...
                                </div>
                            </>
                        )}
                    </div>
                </div>
            );
        }

        // ==================== ìˆ˜ë™ SMS ì „ì†¡ í™”ë©´ ====================
        function ManualSMSScreen({ contacts, location, battery, onBack }) {
            const message = `[ê¸´ê¸‰] ë¸”ë™ì•„ì›ƒ ê°€ë””ì–¸
ì‹œê°: ${new Date().toLocaleString('ko-KR')}
ìœ„ì¹˜: https://maps.google.com/?q=${location.latitude},${location.longitude}
ë°°í„°ë¦¬: ${battery}%`;

            const sendToContact = (contact) => {
                const link = document.createElement('a');
                link.href = `sms:${contact.phone}?body=${encodeURIComponent(message)}`;
                link.click();
            };

            return (
                <div className="min-h-screen bg-gray-50">
                    <div className="bg-white shadow-sm p-6 flex items-center">
                        <button
                            onClick={onBack}
                            className="text-3xl text-gray-600 hover:text-gray-800 mr-4"
                        >
                            â†
                        </button>
                        <h2 className="text-3xl font-bold text-gray-800">ğŸ“± ê¸´ê¸‰ ë¬¸ì ì „ì†¡</h2>
                    </div>

                    <div className="p-6 space-y-4">
                        <div className="bg-yellow-50 border-l-4 border-yellow-500 p-4 mb-6">
                            <p className="text-yellow-800 font-semibold">ê° ì—°ë½ì²˜ ë²„íŠ¼ì„ íƒ­í•˜ì—¬ ë¬¸ìë¥¼ ì „ì†¡í•˜ì„¸ìš”</p>
                        </div>

                        {contacts.map((contact, index) => (
                            <button
                                key={contact.id}
                                onClick={() => sendToContact(contact)}
                                className="w-full bg-white rounded-xl shadow-md p-6 flex items-center justify-between hover:shadow-lg transition-all active:scale-95"
                            >
                                <div className="flex items-center space-x-4">
                                    <div className="w-12 h-12 bg-red-500 rounded-full flex items-center justify-center text-2xl font-bold text-white">
                                        {index + 1}
                                    </div>
                                    <div className="text-left">
                                        <h3 className="text-2xl font-bold text-gray-800">{contact.name}</h3>
                                        <p className="text-lg text-gray-500">{contact.phone}</p>
                                    </div>
                                </div>
                                <div className="text-3xl">ğŸ“¨</div>
                            </button>
                        ))}

                        <div className="bg-white rounded-xl shadow-md p-6 mt-8">
                            <h3 className="text-xl font-bold text-gray-800 mb-3">ì „ì†¡ë  ë©”ì‹œì§€ ë¯¸ë¦¬ë³´ê¸°</h3>
                            <div className="bg-gray-100 p-4 rounded-lg">
                                <pre className="text-sm text-gray-700 whitespace-pre-wrap">{message}</pre>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // ==================== ì—°ë½ì²˜ ê´€ë¦¬ í™”ë©´ ====================
        function ContactsScreen({ contacts, setContacts, onBack }) {
            const [isAdding, setIsAdding] = useState(false);
            const [newContact, setNewContact] = useState({ name: '', phone: '' });

            const addContact = () => {
                if (newContact.name && newContact.phone) {
                    // ì „í™”ë²ˆí˜¸ì—ì„œ í•˜ì´í”ˆ ì œê±°
                    const cleanPhone = newContact.phone.replace(/-/g, '');
                    
                    setContacts([
                        ...contacts,
                        {
                            id: Date.now(),
                            name: newContact.name,
                            phone: cleanPhone,
                            priority: contacts.length + 1
                        }
                    ]);
                    setNewContact({ name: '', phone: '' });
                    setIsAdding(false);
                }
            };

            const deleteContact = (id) => {
                if (confirm('ì´ ì—°ë½ì²˜ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    setContacts(contacts.filter(c => c.id !== id));
                }
            };

            return (
                <div className="min-h-screen bg-gray-50">
                    <div className="bg-white shadow-sm p-6 flex items-center justify-between">
                        <button
                            onClick={onBack}
                            className="text-3xl text-gray-600 hover:text-gray-800"
                        >
                            â† 
                        </button>
                        <h2 className="text-3xl font-bold text-gray-800">ğŸ‘¥ ë¹„ìƒ ì—°ë½ì²˜</h2>
                        <button
                            onClick={() => setIsAdding(true)}
                            className="text-3xl text-blue-600 hover:text-blue-700"
                        >
                            +
                        </button>
                    </div>

                    <div className="p-6 space-y-4">
                        <div className="bg-blue-50 border-l-4 border-blue-500 p-4 mb-4">
                            <p className="text-blue-800 text-sm">ğŸ’¡ ì „í™”ë²ˆí˜¸ëŠ” í•˜ì´í”ˆ ì—†ì´ ì €ì¥ë©ë‹ˆë‹¤ (ì˜ˆ: 01012345678)</p>
                        </div>

                        {contacts.map((contact, index) => (
                            <div key={contact.id} className="bg-white rounded-xl shadow-md p-6 flex items-center justify-between">
                                <div className="flex items-center space-x-4">
                                    <div className="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center text-2xl font-bold text-blue-600">
                                        {index + 1}
                                    </div>
                                    <div>
                                        <h3 className="text-2xl font-bold text-gray-800">{contact.name}</h3>
                                        <p className="text-lg text-gray-500">{contact.phone}</p>
                                    </div>
                                </div>
                                <button
                                    onClick={() => deleteContact(contact.id)}
                                    className="text-3xl text-red-500 hover:text-red-700"
                                >
                                    ğŸ—‘ï¸
                                </button>
                            </div>
                        ))}
                    </div>

                    {isAdding && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-6 z-50">
                            <div className="bg-white rounded-2xl p-8 w-full max-w-md space-y-6">
                                <h3 className="text-3xl font-bold text-gray-800">ìƒˆ ì—°ë½ì²˜ ì¶”ê°€</h3>
                                
                                <input
                                    type="text"
                                    placeholder="ì´ë¦„"
                                    value={newContact.name}
                                    onChange={(e) => setNewContact({ ...newContact, name: e.target.value })}
                                    className="w-full px-6 py-4 text-2xl border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:outline-none"
                                />
                                
                                <input
                                    type="tel"
                                    placeholder="ì „í™”ë²ˆí˜¸ (01012345678)"
                                    value={newContact.phone}
                                    onChange={(e) => setNewContact({ ...newContact, phone: e.target.value })}
                                    className="w-full px-6 py-4 text-2xl border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:outline-none"
                                />
                                
                                <div className="flex space-x-4">
                                    <button
                                        onClick={() => setIsAdding(false)}
                                        className="flex-1 py-4 text-xl font-bold text-gray-600 bg-gray-200 hover:bg-gray-300 rounded-xl"
                                    >
                                        ì·¨ì†Œ
                                    </button>
                                    <button
                                        onClick={addContact}
                                        className="flex-1 py-4 text-xl font-bold text-white bg-blue-600 hover:bg-blue-700 rounded-xl"
                                    >
                                        ì¶”ê°€
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        // ==================== ì„¤ì • í™”ë©´ ====================
        function SettingsScreen({ settings, setSettings, emergencyLogs, onBack }) {
            return (
                <div className="min-h-screen bg-gray-50">
                    <div className="bg-white shadow-sm p-6 flex items-center">
                        <button
                            onClick={onBack}
                            className="text-3xl text-gray-600 hover:text-gray-800 mr-4"
                        >
                            â†
                        </button>
                        <h2 className="text-3xl font-bold text-gray-800">âš™ï¸ ì„¤ì •</h2>
                    </div>

                    <div className="p-6 space-y-6">
                        {/* SMS ì „ì†¡ ë°©ë²• ì„ íƒ */}
                        <div className="bg-white rounded-xl shadow-md p-6">
                            <h3 className="text-2xl font-bold text-gray-800 mb-4">ğŸ“± SMS ì „ì†¡ ë°©ë²•</h3>
                            <div className="space-y-3">
                                <label className="flex items-center p-4 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100">
                                    <input
                                        type="radio"
                                        name="smsMethod"
                                        value="auto-click"
                                        checked={settings.smsMethod === 'auto-click'}
                                        onChange={(e) => setSettings({ ...settings, smsMethod: e.target.value })}
                                        className="w-6 h-6 mr-4"
                                    />
                                    <div>
                                        <div className="text-lg font-semibold">ìë™ í´ë¦­ (ê¶Œì¥)</div>
                                        <div className="text-sm text-gray-500">ë™ì  ë§í¬ ìƒì„± + ìë™ í´ë¦­</div>
                                    </div>
                                </label>
                                
                                <label className="flex items-center p-4 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100">
                                    <input
                                        type="radio"
                                        name="smsMethod"
                                        value="intent"
                                        checked={settings.smsMethod === 'intent'}
                                        onChange={(e) => setSettings({ ...settings, smsMethod: e.target.value })}
                                        className="w-6 h-6 mr-4"
                                    />
                                    <div>
                                        <div className="text-lg font-semibold">ì•ˆë“œë¡œì´ë“œ ì¸í…íŠ¸</div>
                                        <div className="text-sm text-gray-500">ë” ê°•ë ¥í•œ ë°©ë²• (ì¼ë¶€ ê¸°ê¸°)</div>
                                    </div>
                                </label>
                                
                                <label className="flex items-center p-4 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100">
                                    <input
                                        type="radio"
                                        name="smsMethod"
                                        value="manual"
                                        checked={settings.smsMethod === 'manual'}
                                        onChange={(e) => setSettings({ ...settings, smsMethod: e.target.value })}
                                        className="w-6 h-6 mr-4"
                                    />
                                    <div>
                                        <div className="text-lg font-semibold">ìˆ˜ë™ ì „ì†¡</div>
                                        <div className="text-sm text-gray-500">ê° ì—°ë½ì²˜ ë²„íŠ¼ ê°œë³„ í´ë¦­</div>
                                    </div>
                                </label>
                            </div>
                        </div>

                        {/* ì¹´ìš´íŠ¸ë‹¤ìš´ ì‹œê°„ */}
                        <div className="bg-white rounded-xl shadow-md p-6">
                            <h3 className="text-2xl font-bold text-gray-800 mb-4">â±ï¸ ì¹´ìš´íŠ¸ë‹¤ìš´ ì‹œê°„</h3>
                            <div className="flex items-center justify-between">
                                <span className="text-xl text-gray-600">{settings.countdownSeconds}ì´ˆ</span>
                                <input
                                    type="range"
                                    min="15"
                                    max="60"
                                    step="5"
                                    value={settings.countdownSeconds}
                                    onChange={(e) => setSettings({ ...settings, countdownSeconds: parseInt(e.target.value) })}
                                    className="w-48 h-3"
                                />
                            </div>
                        </div>

                        {/* ì§„ë™ ì•Œë¦¼ */}
                        <div className="bg-white rounded-xl shadow-md p-6">
                            <div className="flex items-center justify-between">
                                <div>
                                    <h3 className="text-2xl font-bold text-gray-800">ğŸ“³ ì§„ë™ ì•Œë¦¼</h3>
                                    <p className="text-lg text-gray-500 mt-1">ì¹´ìš´íŠ¸ë‹¤ìš´ ì‹œ ì§„ë™ìœ¼ë¡œ ì•Œë¦¼</p>
                                </div>
                                <button
                                    onClick={() => setSettings({ ...settings, enableVibration: !settings.enableVibration })}
                                    className={`w-20 h-10 rounded-full transition-colors ${
                                        settings.enableVibration ? 'bg-blue-600' : 'bg-gray-300'
                                    }`}
                                >
                                    <div className={`w-8 h-8 bg-white rounded-full shadow-md transform transition-transform ${
                                        settings.enableVibration ? 'translate-x-10' : 'translate-x-1'
                                    }`} />
                                </button>
                            </div>
                        </div>

                        {/* ê¸´ê¸‰ ë¡œê·¸ */}
                        <div className="bg-white rounded-xl shadow-md p-6">
                            <h3 className="text-2xl font-bold text-gray-800 mb-4">ğŸ“œ ê¸´ê¸‰ ì´ë²¤íŠ¸ ê¸°ë¡</h3>
                            {emergencyLogs.length === 0 ? (
                                <p className="text-lg text-gray-400 text-center py-8">ì•„ì§ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤</p>
                            ) : (
                                <div className="space-y-3">
                                    {emergencyLogs.slice(0, 5).map((log) => (
                                        <div key={log.id} className="border-l-4 border-red-500 pl-4 py-2">
                                            <div className="text-lg font-semibold text-gray-800">{log.timestamp}</div>
                                            <div className="text-sm text-gray-600">
                                                ìœ„ì¹˜: {log.location.latitude.toFixed(6)}, {log.location.longitude.toFixed(6)}
                                            </div>
                                            <div className="text-sm text-gray-600">ë°°í„°ë¦¬: {log.battery}%</div>
                                            <div className="text-sm text-gray-600">ì „ì†¡: {log.contacts}</div>
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        // ==================== ì•± ë Œë”ë§ ====================
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<BlackoutGuardianApp />);
    </script>
</body>
</html>
