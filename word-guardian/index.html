<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>ê±´ê°• ë‹¨ì–´ íŒ¡íŒ¡! ğŸŒŸ</title>
<link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">
<style>
:root {
  --green: #56c271;
  --dark-green: #2e8b50;
  --red: #ff5a5a;
  --yellow: #ffd93d;
  --blue: #6ec6ff;
  --purple: #c084fc;
  --bg: #e8f5e9;
  --block-color: #81c784;
  --block-border: #4caf50;
}

* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

body {
  margin: 0; padding: 0; overflow: hidden;
  background: linear-gradient(160deg, #d4f5d4 0%, #e8f5e9 50%, #c8e6c9 100%);
  font-family: 'Jua', sans-serif;
  touch-action: none;
  user-select: none;
}

/* â”€â”€â”€ FLOATING CLOUDS â”€â”€â”€ */
.cloud {
  position: fixed; background: rgba(255,255,255,0.6);
  border-radius: 50px; z-index: 0; animation: drift linear infinite;
}
.cloud::before, .cloud::after {
  content:''; position:absolute; background: rgba(255,255,255,0.6); border-radius:50%;
}
@keyframes drift { from{transform:translateX(-200px)} to{transform:translateX(110vw)} }

/* â”€â”€â”€ GAME VIEW â”€â”€â”€ */
#game-view {
  position: relative; width: 100vw; height: 100vh;
  overflow: hidden; z-index: 1;
}

/* â”€â”€â”€ TOP HUD â”€â”€â”€ */
#hud {
  position: absolute; top: 12px; left: 50%; transform: translateX(-50%);
  width: 94%; display: flex; justify-content: space-between; align-items: center;
  background: rgba(255,255,255,0.92);
  border-radius: 25px; padding: 8px 18px;
  box-shadow: 0 4px 16px rgba(0,0,0,0.12); z-index: 200;
  border: 3px solid var(--green);
}
.hud-item { display: flex; align-items: center; gap: 5px; font-size: 18px; }
.hud-hearts { font-size: 22px; letter-spacing: 2px; }
#score-num { color: var(--dark-green); font-size: 22px; }

/* â”€â”€â”€ PROGRESS BAR â”€â”€â”€ */
#progress-wrap {
  position: absolute; top: 72px; left: 50%; transform: translateX(-50%);
  width: 90%; z-index: 200;
}
#progress-bar-bg {
  background: rgba(255,255,255,0.7); border-radius: 20px;
  height: 12px; overflow: hidden; border: 2px solid var(--green);
}
#progress-bar-fill {
  height: 100%; background: linear-gradient(90deg, #56c271, #ffd93d);
  border-radius: 20px; transition: width 0.4s ease;
  width: 100%;
}

/* â”€â”€â”€ HIDDEN IMAGE (center) â”€â”€â”€ */
#reward-wrap {
  position: absolute;
  top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  width: min(280px, 70vw);
  height: min(280px, 70vw);
  z-index: 5;
}
#reward-img {
  width: 100%; height: 100%;
  font-size: min(160px, 40vw);
  display: flex; align-items: center; justify-content: center;
  border-radius: 20px;
  background: linear-gradient(135deg, #fffde7, #f1f8e9);
  border: 4px solid white;
  box-shadow: 0 8px 24px rgba(0,0,0,0.15);
}
#block-overlay {
  position: absolute; inset: 0;
  display: grid;
  grid-template-columns: repeat(6, 1fr);
  grid-template-rows: repeat(6, 1fr);
  border-radius: 16px; overflow: hidden;
}
.block {
  background: var(--block-color);
  border: 1.5px solid rgba(255,255,255,0.5);
  transition: transform 0.35s cubic-bezier(.36,.07,.19,.97), opacity 0.35s ease;
  display: flex; align-items: center; justify-content: center;
  font-size: 16px;
}
.block.broken {
  transform: scale(0) rotate(120deg) !important;
  opacity: 0 !important;
  pointer-events: none;
}

/* â”€â”€â”€ FALLING UNITS â”€â”€â”€ */
.unit {
  position: absolute;
  display: flex; flex-direction: column; align-items: center;
  cursor: pointer; z-index: 50;
  animation: fall linear forwards;
  will-change: transform;
}
.unit-emoji {
  font-size: 54px; line-height: 1;
  filter: drop-shadow(0 4px 6px rgba(0,0,0,0.18));
  transition: transform 0.1s;
}
.unit-label {
  background: white;
  padding: 3px 12px;
  border-radius: 20px;
  font-size: 15px;
  margin-top: -6px;
  box-shadow: 0 3px 8px rgba(0,0,0,0.15);
  border: 2px solid var(--green);
  color: #2e7d32;
  font-weight: bold;
}
.unit.bad .unit-label {
  border-color: var(--red);
  color: var(--red);
}

@keyframes fall {
  0%   { transform: translateY(-110px); }
  100% { transform: translateY(110vh); }
}

/* â”€â”€â”€ TAP EFFECTS â”€â”€â”€ */
.pop-particle {
  position: absolute; width: 12px; height: 12px; border-radius: 50%;
  pointer-events: none; z-index: 300;
  animation: pop-fly 0.65s ease-out forwards;
}
@keyframes pop-fly {
  0%   { transform: translate(0,0) scale(1); opacity: 1; }
  100% { transform: translate(var(--tx), var(--ty)) scale(0); opacity: 0; }
}

.tap-ring {
  position: absolute; border-radius: 50%; pointer-events: none; z-index: 300;
  width: 60px; height: 60px; margin: -30px;
  border: 3px solid var(--yellow);
  animation: ring-expand 0.5s ease-out forwards;
}
@keyframes ring-expand {
  0%   { transform: scale(0.5); opacity: 1; }
  100% { transform: scale(2);   opacity: 0; }
}

.score-popup {
  position: absolute; z-index: 400; font-size: 26px;
  font-weight: bold; pointer-events: none;
  animation: float-up 0.9s ease-out forwards;
}
@keyframes float-up {
  0%   { transform: translateY(0); opacity: 1; }
  100% { transform: translateY(-80px); opacity: 0; }
}

/* â”€â”€â”€ WRONG FLASH â”€â”€â”€ */
#wrong-flash {
  position: fixed; inset: 0; background: rgba(255,80,80,0.3);
  z-index: 500; pointer-events: none; opacity: 0;
  transition: opacity 0.1s;
}

/* â”€â”€â”€ SCREENS â”€â”€â”€ */
.screen {
  position: absolute; inset: 0; z-index: 1000;
  display: flex; flex-direction: column;
  align-items: center; justify-content: center;
  background: rgba(255,255,255,0.97);
}
.screen h1 { font-size: 42px; margin: 10px 0; }
.screen p  { font-size: 18px; text-align: center; color: #555; line-height: 1.7; max-width: 320px; }

.big-btn {
  padding: 18px 55px; font-size: 28px; font-family: 'Jua', sans-serif;
  background: var(--green); color: white; border: none;
  border-radius: 50px; cursor: pointer;
  box-shadow: 0 7px 0 var(--dark-green);
  transition: transform 0.1s, box-shadow 0.1s;
  margin-top: 20px;
}
.big-btn:active { transform: translateY(4px); box-shadow: 0 3px 0 var(--dark-green); }
.big-btn.red-btn { background: #ff5a5a; box-shadow: 0 7px 0 #c62828; }

.reward-big { font-size: 90px; animation: bounce-in 0.5s; }
@keyframes bounce-in {
  0%   { transform: scale(0) rotate(-20deg); }
  60%  { transform: scale(1.2) rotate(5deg); }
  100% { transform: scale(1) rotate(0); }
}

/* â”€â”€â”€ WORD HINT BAR â”€â”€â”€ */
#hint-bar {
  position: absolute; bottom: 14px; left: 50%; transform: translateX(-50%);
  width: 94%; background: rgba(255,255,255,0.9); border-radius: 20px;
  padding: 8px 14px; text-align: center; font-size: 14px; color: #555;
  border: 2px solid var(--block-color); z-index: 200;
  box-shadow: 0 3px 10px rgba(0,0,0,0.08);
}
#hint-bar strong { color: var(--dark-green); }
#hint-bar span   { color: var(--red); }

/* â”€â”€â”€ COMBO â”€â”€â”€ */
#combo-display {
  position: absolute; top: 110px; right: 10px;
  font-size: 28px; z-index: 200;
  animation: none; pointer-events: none;
}
.combo-pop { animation: combo-bounce 0.4s ease; }
@keyframes combo-bounce {
  0%  { transform: scale(1); }
  50% { transform: scale(1.6); }
  100%{ transform: scale(1); }
}
</style>
</head>
<body>

<!-- Clouds -->
<div class="cloud" style="width:120px;height:40px;top:8%;animation-duration:22s;animation-delay:-5s;">
  <div style="width:60px;height:60px;top:-30px;left:20px;position:absolute;background:rgba(255,255,255,0.6);border-radius:50%;"></div>
  <div style="width:40px;height:40px;top:-20px;left:55px;position:absolute;background:rgba(255,255,255,0.6);border-radius:50%;"></div>
</div>
<div class="cloud" style="width:160px;height:50px;top:20%;animation-duration:30s;animation-delay:-12s;">
  <div style="width:80px;height:80px;top:-40px;left:25px;position:absolute;background:rgba(255,255,255,0.6);border-radius:50%;"></div>
  <div style="width:55px;height:55px;top:-28px;left:75px;position:absolute;background:rgba(255,255,255,0.6);border-radius:50%;"></div>
</div>

<div id="game-view">
  <!-- HUD -->
  <div id="hud">
    <div class="hud-item">ğŸ’š <span class="hud-hearts" id="hearts">â¤ï¸â¤ï¸â¤ï¸</span></div>
    <div class="hud-item">â­ <span id="score-num">0</span></div>
    <div class="hud-item">ğŸ§© <span id="block-count">36</span></div>
  </div>

  <!-- Progress -->
  <div id="progress-wrap">
    <div id="progress-bar-bg"><div id="progress-bar-fill"></div></div>
  </div>

  <!-- Combo -->
  <div id="combo-display"></div>

  <!-- Reward Image -->
  <div id="reward-wrap">
    <div id="reward-img">ğŸŒŸ</div>
    <div id="block-overlay"></div>
  </div>

  <!-- Hint -->
  <div id="hint-bar">
    <strong>âœ… ê±´ê°• ë‹¨ì–´</strong>ë¥¼ í„°ì¹˜! &nbsp;
    <span>âŒ ë‚˜ìœ ë‹¨ì–´</span>ëŠ” í”¼í•´ìš”!
  </div>

  <!-- Wrong Flash -->
  <div id="wrong-flash"></div>

  <!-- START SCREEN -->
  <div class="screen" id="start-screen">
    <div style="font-size:80px;animation:bounce-in 0.6s">ğŸ¥¦</div>
    <h1 style="color:#2e7d32;">ê±´ê°• ë‹¨ì–´ íŒ¡íŒ¡!</h1>
    <p>ë‚´ë ¤ì˜¤ëŠ” <strong style="color:var(--dark-green)">ê±´ê°• ë‹¨ì–´</strong>ë¥¼ í„°ì¹˜í•´ì„œ<br>
       ë¸”ë¡ì„ ë¶€ìˆ˜ê³  ìˆ¨ê²¨ì§„ ê·¸ë¦¼ì„ ì°¾ì•„ìš”!<br><br>
       <span style="color:var(--red)">ë‚˜ìœ ë‹¨ì–´</span>ë¥¼ í„°ì¹˜í•˜ë©´ í•˜íŠ¸ë¥¼ ìƒì–´ìš” ğŸ’”</p>
    <button class="big-btn" id="start-btn">ğŸŒŸ ì‹œì‘!</button>
  </div>

  <!-- CLEAR SCREEN -->
  <div class="screen" id="clear-screen" style="display:none;">
    <div class="reward-big">ğŸ‰</div>
    <h1 style="color:#2e7d32;">ì™„ì„±!</h1>
    <p>ëª¨ë“  ë¸”ë¡ì„ ë‹¤ ë¶€ì‰ˆì–´ìš”!<br>ìµœì¢… ì ìˆ˜: <strong id="final-score" style="color:var(--dark-green);font-size:28px;"></strong></p>
    <button class="big-btn" id="restart-btn">ğŸ”„ ë‹¤ì‹œ í•˜ê¸°</button>
  </div>

  <!-- GAME OVER SCREEN -->
  <div class="screen" id="over-screen" style="display:none;">
    <div style="font-size:80px;">ğŸ’”</div>
    <h1 style="color:var(--red);">ê²Œì„ ì˜¤ë²„!</h1>
    <p>í•˜íŠ¸ê°€ ëª¨ë‘ ì—†ì–´ì¡Œì–´ìš”<br>ì ìˆ˜: <strong id="over-score" style="color:var(--red);font-size:28px;"></strong></p>
    <button class="big-btn red-btn" id="over-restart-btn">ğŸ”„ ë‹¤ì‹œ í•˜ê¸°</button>
  </div>
</div>

<script>
// â”€â”€â”€ DATA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const GOOD_WORDS = [
  { word:'apple',    emoji:'ğŸ', ko:'ì‚¬ê³¼' },
  { word:'water',    emoji:'ğŸ’§', ko:'ë¬¼' },
  { word:'banana',   emoji:'ğŸŒ', ko:'ë°”ë‚˜ë‚˜' },
  { word:'carrot',   emoji:'ğŸ¥•', ko:'ë‹¹ê·¼' },
  { word:'milk',     emoji:'ğŸ¥›', ko:'ìš°ìœ ' },
  { word:'broccoli', emoji:'ğŸ¥¦', ko:'ë¸Œë¡œì½œë¦¬' },
  { word:'orange',   emoji:'ğŸŠ', ko:'ì˜¤ë Œì§€' },
  { word:'grape',    emoji:'ğŸ‡', ko:'í¬ë„' },
  { word:'tomato',   emoji:'ğŸ…', ko:'í† ë§ˆí† ' },
  { word:'exercise', emoji:'ğŸƒ', ko:'ìš´ë™' },
  { word:'sleep',    emoji:'ğŸ˜´', ko:'ìˆ˜ë©´' },
  { word:'salad',    emoji:'ğŸ¥—', ko:'ìƒëŸ¬ë“œ' },
  { word:'corn',     emoji:'ğŸŒ½', ko:'ì˜¥ìˆ˜ìˆ˜' },
  { word:'egg',      emoji:'ğŸ¥š', ko:'ë‹¬ê±€' },
  { word:'fish',     emoji:'ğŸŸ', ko:'ìƒì„ ' },
];

const BAD_WORDS = [
  { word:'burger',    emoji:'ğŸ”', ko:'ë²„ê±°' },
  { word:'candy',     emoji:'ğŸ¬', ko:'ì‚¬íƒ•' },
  { word:'soda',      emoji:'ğŸ¥¤', ko:'íƒ„ì‚°ìŒë£Œ' },
  { word:'fries',     emoji:'ğŸŸ', ko:'ê°ìíŠ€ê¹€' },
  { word:'cookie',    emoji:'ğŸª', ko:'ì¿ í‚¤' },
  { word:'donut',     emoji:'ğŸ©', ko:'ë„ë„›' },
  { word:'lazy',      emoji:'ğŸ›‹ï¸', ko:'ê²Œìœ¼ë¦„' },
  { word:'junk',      emoji:'ğŸ—‘ï¸', ko:'ì •í¬í‘¸ë“œ' },
  { word:'chips',     emoji:'ğŸ¥¨', ko:'ê³¼ì' },
  { word:'cake',      emoji:'ğŸ‚', ko:'ì¼€ì´í¬' },
];

const REWARD_EMOJIS = ['ğŸŒˆ','ğŸ¦„','ğŸ¬','ğŸ¦‹','ğŸŒ¸','ğŸ ','ğŸ†','ğŸŒŸ','ğŸ¼','ğŸ¦'];

// â”€â”€â”€ STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let score = 0, lives = 3, combo = 0, blocksLeft = 36;
let active = false, spawnTimer = null, blocks = [];
let audioCtx = null;

// â”€â”€â”€ AUDIO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function getAudioCtx() {
  if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  return audioCtx;
}

function playTone(freq, type='sine', dur=0.18, vol=0.3) {
  try {
    const ctx = getAudioCtx();
    const osc = ctx.createOscillator();
    const gain = ctx.createGain();
    osc.connect(gain); gain.connect(ctx.destination);
    osc.type = type; osc.frequency.value = freq;
    gain.gain.setValueAtTime(vol, ctx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + dur);
    osc.start(ctx.currentTime); osc.stop(ctx.currentTime + dur);
  } catch(e){}
}

function playGoodSound() {
  playTone(523, 'sine', 0.12, 0.35);
  setTimeout(() => playTone(659, 'sine', 0.12, 0.35), 80);
  setTimeout(() => playTone(784, 'sine', 0.18, 0.3), 160);
}

function playBadSound() {
  playTone(200, 'sawtooth', 0.25, 0.4);
  setTimeout(() => playTone(160, 'sawtooth', 0.2, 0.3), 120);
}

function playClearSound() {
  const notes = [523,659,784,1047];
  notes.forEach((f,i) => setTimeout(() => playTone(f,'sine',0.22,0.4), i*110));
}

// â”€â”€â”€ BACKGROUND MUSIC (Web Audio - cheerful children's melody) â”€
let bgMusicInterval = null;
const melody = [
  [523,0],[659,160],[784,320],[659,480],[523,640],
  [784,800],[880,960],[784,1120],[659,1280],[523,1440],
  [392,1600],[523,1760],[659,1920],[784,2080],[880,2240],
  [784,2400],[659,2560],[523,2720],[659,2880],[784,3040],
];
function startBgMusic() {
  if (bgMusicInterval) return;
  let cycle = 0;
  function playChunk() {
    if (!active) return;
    const ctx = getAudioCtx();
    const baseTime = ctx.currentTime;
    melody.forEach(([freq, ms]) => {
      const osc = ctx.createOscillator();
      const g = ctx.createGain();
      osc.connect(g); g.connect(ctx.destination);
      osc.type = 'triangle'; osc.frequency.value = freq;
      const t = baseTime + ms/1000;
      g.gain.setValueAtTime(0.06, t);
      g.gain.exponentialRampToValueAtTime(0.001, t + 0.14);
      osc.start(t); osc.stop(t + 0.15);
    });
    bgMusicInterval = setTimeout(playChunk, 3400);
  }
  playChunk();
}
function stopBgMusic() {
  if (bgMusicInterval) { clearTimeout(bgMusicInterval); bgMusicInterval = null; }
}

// â”€â”€â”€ VIBRATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function vibrate(pattern) {
  try { if (navigator.vibrate) navigator.vibrate(pattern); } catch(e){}
}

// â”€â”€â”€ BLOCK GRID â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function buildBlocks() {
  const overlay = document.getElementById('block-overlay');
  overlay.innerHTML = '';
  blocks = [];
  const decorations = ['ğŸŒ¿','ğŸ€','â­','ğŸŒ¸','ğŸ’«','ğŸŒˆ','ğŸˆ','ğŸ¦‹','ğŸŒŸ','â„ï¸','ğŸƒ','âœ¨'];
  for (let i = 0; i < 36; i++) {
    const div = document.createElement('div');
    div.className = 'block';
    div.textContent = decorations[i % decorations.length];
    blocks.push(div);
    overlay.appendChild(div);
  }
  blocksLeft = 36;
  document.getElementById('block-count').textContent = '36';
  document.getElementById('progress-bar-fill').style.width = '100%';
}

function breakBlock() {
  const remaining = blocks.filter(b => !b.classList.contains('broken'));
  if (remaining.length === 0) return;
  const idx = Math.floor(Math.random() * remaining.length);
  remaining[idx].classList.add('broken');
  blocksLeft--;
  document.getElementById('block-count').textContent = blocksLeft;
  const pct = (blocksLeft / 36) * 100;
  document.getElementById('progress-bar-fill').style.width = pct + '%';
  if (blocksLeft === 0) setTimeout(showClear, 400);
}

// â”€â”€â”€ SCORE / LIVES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function updateHearts() {
  const h = ['â¤ï¸','â¤ï¸','â¤ï¸'];
  for (let i = lives; i < 3; i++) h[i] = 'ğŸ–¤';
  document.getElementById('hearts').textContent = h.join('');
}

function addScore(val, x, y) {
  score += val;
  document.getElementById('score-num').textContent = score;
  const pop = document.createElement('div');
  pop.className = 'score-popup';
  pop.textContent = (val > 0 ? '+' : '') + val;
  pop.style.color = val > 0 ? '#2e7d32' : '#f44336';
  pop.style.left = x + 'px'; pop.style.top = y + 'px';
  document.getElementById('game-view').appendChild(pop);
  pop.addEventListener('animationend', () => pop.remove());
}

// â”€â”€â”€ PARTICLES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function spawnParticles(x, y, colors) {
  const view = document.getElementById('game-view');
  for (let i = 0; i < 16; i++) {
    const p = document.createElement('div');
    p.className = 'pop-particle';
    p.style.background = colors[i % colors.length];
    p.style.left = x + 'px'; p.style.top = y + 'px';
    const angle = (i / 16) * Math.PI * 2;
    const dist = 60 + Math.random() * 80;
    p.style.setProperty('--tx', Math.cos(angle)*dist + 'px');
    p.style.setProperty('--ty', Math.sin(angle)*dist + 'px');
    view.appendChild(p);
    p.addEventListener('animationend', () => p.remove());
  }
  const ring = document.createElement('div');
  ring.className = 'tap-ring';
  ring.style.left = x + 'px'; ring.style.top = y + 'px';
  view.appendChild(ring);
  ring.addEventListener('animationend', () => ring.remove());
}

// â”€â”€â”€ SPAWN FALLING UNIT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function spawnUnit() {
  if (!active) return;
  const isGood = Math.random() < 0.55;
  const pool = isGood ? GOOD_WORDS : BAD_WORDS;
  const data = pool[Math.floor(Math.random() * pool.length)];
  const view = document.getElementById('game-view');

  const unit = document.createElement('div');
  unit.className = 'unit' + (isGood ? '' : ' bad');
  unit.innerHTML = `<div class="unit-emoji">${data.emoji}</div>
                    <div class="unit-label">${data.word}</div>`;

  const x = 20 + Math.random() * (window.innerWidth - 100);
  unit.style.left = x + 'px';
  unit.style.top = '0px';

  const speed = 3.5 + Math.random() * 3 + (score / 500);
  unit.style.animation = `fall ${speed}s linear forwards`;

  unit.addEventListener(isTouchDevice() ? 'touchstart' : 'mousedown', (e) => {
    e.preventDefault();
    if (!active) return;
    const rect = unit.getBoundingClientRect();
    const cx = rect.left + rect.width / 2;
    const cy = rect.top + rect.height / 2;

    unit.remove();

    if (isGood) {
      // Good tap
      vibrate(30);
      playGoodSound();
      combo++;
      const bonusScore = 10 * (combo >= 3 ? 2 : 1);
      addScore(bonusScore, cx, cy);
      spawnParticles(cx, cy, ['#56c271','#ffd93d','#6ec6ff','#c084fc','#ff8a65']);
      breakBlock();
      showCombo();
    } else {
      // Bad tap
      vibrate([60,30,60]);
      playBadSound();
      combo = 0;
      addScore(-15, cx, cy);
      document.getElementById('combo-display').textContent = '';
      spawnParticles(cx, cy, ['#ff5a5a','#ff8a65','#ffcc02']);
      const flash = document.getElementById('wrong-flash');
      flash.style.opacity = '1';
      setTimeout(() => flash.style.opacity = '0', 200);
      lives--;
      if (lives < 0) lives = 0;
      updateHearts();
      if (lives === 0) { setTimeout(showGameOver, 300); return; }
    }
  }, {passive: false});

  view.appendChild(unit);

  // Remove if hits bottom
  unit.addEventListener('animationend', () => {
    if (unit.parentNode) unit.remove();
  });

  // Schedule next spawn
  const delay = Math.max(600, 1400 - score * 0.8);
  spawnTimer = setTimeout(spawnUnit, delay);
}

function showCombo() {
  const el = document.getElementById('combo-display');
  if (combo >= 3) {
    el.textContent = `ğŸ”¥ ${combo} ì½¤ë³´!`;
    el.classList.remove('combo-pop');
    void el.offsetWidth;
    el.classList.add('combo-pop');
    if (combo % 3 === 0) playTone(1047, 'sine', 0.2, 0.5);
  } else {
    el.textContent = '';
  }
}

// â”€â”€â”€ SCREENS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showClear() {
  active = false; stopBgMusic();
  clearTimeout(spawnTimer);
  playClearSound(); vibrate([100,50,100,50,200]);
  document.querySelectorAll('.unit').forEach(u => u.remove());
  document.getElementById('final-score').textContent = score + 'ì ';
  document.getElementById('clear-screen').style.display = 'flex';
}

function showGameOver() {
  active = false; stopBgMusic();
  clearTimeout(spawnTimer);
  playBadSound();
  document.querySelectorAll('.unit').forEach(u => u.remove());
  document.getElementById('over-score').textContent = score + 'ì ';
  document.getElementById('over-screen').style.display = 'flex';
}

function startGame() {
  score = 0; lives = 3; combo = 0; blocksLeft = 36;
  document.getElementById('score-num').textContent = '0';
  document.getElementById('combo-display').textContent = '';
  updateHearts();
  buildBlocks();
  // Random reward emoji
  document.getElementById('reward-img').textContent =
    REWARD_EMOJIS[Math.floor(Math.random() * REWARD_EMOJIS.length)];
  document.querySelectorAll('.unit').forEach(u => u.remove());
  ['start-screen','clear-screen','over-screen'].forEach(id => {
    document.getElementById(id).style.display = 'none';
  });
  active = true;
  clearTimeout(spawnTimer);
  spawnTimer = setTimeout(spawnUnit, 600);
  startBgMusic();
}

// â”€â”€â”€ UTILS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function isTouchDevice() {
  return ('ontouchstart' in window) || navigator.maxTouchPoints > 0;
}

// â”€â”€â”€ INIT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
document.getElementById('start-btn').addEventListener('click', startGame);
document.getElementById('restart-btn').addEventListener('click', startGame);
document.getElementById('over-restart-btn').addEventListener('click', startGame);

buildBlocks();
</script>
</body>
</html>
